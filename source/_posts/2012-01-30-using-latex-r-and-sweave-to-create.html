---
layout: post
title: "Using LaTeX, R, and Sweave to Create Reports in Windows"
date: 2012-01-30T18:24:00-08:00
categories:
 - Windows
 - LaTeX
 - Sweave
 - R
---

<div class='post'>
<a href="http://www.latex-project.org/">LaTeX</a> is a typesetting system that can easily be used to create reports and scientific articles, and has excellent formatting options for displaying code and mathematical formulas.  <a href="http://www.statistik.lmu.de/%7Eleisch/Sweave/">Sweave</a> is a package in base R that can execute R code embedded in LaTeX files and display the output.  This can be used to generate reports and quickly fix errors when needed.<br /><br />There are some barriers to entry with LaTeX that seem much steeper than they actually are.  In this article, I will show you how to setup LaTeX and an IDE for it in Windows, and how to start developing for it.  Note that you will at least R version 2.14 to follow this entire article, because the command line sweave pdf export option was added then.<br /><br /><b>Install MiKTeX and TeXnicCenter</b><br /><br />LaTeX documents are edited in a text editor, then compiled by a compiler, and finally are displayed in a PDF or postscript viewer.  We will begin by installing a LaTeX compiler for Windows, <a href="http://miktex.org/">MiKTeX</a>.  Once you grab the installer, you can go ahead and install it.  Please see the bottom of the post for the full edit, but installing LaTeX in paths with spaces in them can cause issues.  As such, I would recommend installing to a directory without them.<br /><br />Our next step will be to install <a href="http://www.texniccenter.org/">TeXnicCenter</a>, an IDE for LaTeX.  After installing TeXnicCenter and starting it for the first time, you will be asked to find your LaTeX executable file in the configuration wizard. This can generally be found in the folder C:\Program Files\MiKTeX 2.9\miktex\bin by default, or a custom path if you did not use spaces in your path.  You can leave the fields for PostScript viewer blank, unless you need the functionality.  You should now be finished with the installation.<br /><br /><b>Setup TeXnicCenter to Work with Sweave</b><br /><br />Now, we can setup TeXnicCenter to use Sweave directly.  This will require at least R 2.14.  To do this, click on the Build menu and go to Define Output Profiles.  Hit the "Add" button in the bottom left to create a new output profile.  You can name the profile anything you like.  I named mine "Sweave".   <br /><br />Now we need to configure the new output profile.  The first tab should look similar to mine if you use 64-bit R, but your R path will be different if you use 32-bit or used a non-default installation directory.  The directory will need to match yours.  The command line arguments box should read: CMD Sweave --pdf %nm .  <br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-jCXziuoRBIM/TydIiHrghJI/AAAAAAAAADQ/dusNBwWVyiY/s1600/sweave2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-jCXziuoRBIM/TydIiHrghJI/AAAAAAAAADQ/dusNBwWVyiY/s1600/sweave2.png" /></a></div>Now, we only need to worry about the viewer tab.  I use Foxit Reader, so my settings are below.  I suggest using the same settings as you find in your LaTeX=&gt;PDF output profile.  <br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-CczH5S2fDhE/TydMaScDCSI/AAAAAAAAADc/KiA8QIxil2k/s1600/sweave3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-CczH5S2fDhE/TydMaScDCSI/AAAAAAAAADc/KiA8QIxil2k/s1600/sweave3.png" /></a></div>Once we have all that set, you can go ahead and write your first document.  You will need to name the document something.Rnw. To build the file, you will have to select "Sweave"(or whatever you named your profile" in the drop down box below the build item on the menu bar, and then select Build-&gt;Current File-&gt;Build and View to build your first file.  <br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-I4bxBXMUbss/TydN7mQEvVI/AAAAAAAAADo/u8TUvXex2lQ/s1600/sweave4.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-I4bxBXMUbss/TydN7mQEvVI/AAAAAAAAADo/u8TUvXex2lQ/s1600/sweave4.png" /></a></div>The above shows a trivial R script.  &lt;&lt;&gt;&gt;= signifies the start of an R script, and @ signifies the end. <br /><br /><b>Further Reading</b><br /><br />To learn more about Sweave, I suggest reading the <a href="http://www.stat.uni-muenchen.de/%7Eleisch/Sweave/Sweave-manual.pdf">user manual</a>. <a href="http://stackoverflow.com/questions/8366193/writing-big-documents-with-sweave-is-it-possible-to-do-as-with-latex">Here</a> is a good discussion of workflow with big documents and Sweave.  To learn more about LaTeX, I suggest the <a href="http://en.wikibooks.org/wiki/LaTeX">LaTeX wikibook</a>, and <a href="http://tobi.oetiker.ch/lshort/lshort.pdf">The Not So Short Introduction to LaTeX</a>.  <a href="http://amath.colorado.edu/documentation/LaTeX/basics/example.html">This page</a> shows how to make a basic document in LaTeX, and can be a good template to work off of.  This <a href="http://sachaem47.fortyseven.versio.nl/latexcourse/lec4/SweaveInstall.pdf">link</a> gave me some of the concepts used above, and also has instructions for how to use Stangle with TeXnicCenter.   <br/><br/><b>Edit</b> A commenter has pointed out that using a directory path with spaces in it can create bugs in LaTeX.  You can find more information on this <a href="http://tex.stackexchange.com/questions/4315/include-image-with-spaces-in-path-directory-to-be-processed-with-dvips">here</a>, and <a href="http://groups.google.com/group/latexusersgroup/browse_thread/thread/f78aab8bdaedcdf7?pli=1">here</a>.  I have updated my post.</div>
