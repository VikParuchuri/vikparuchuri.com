---
layout: post
title: "Analyzing Federal Government Bailout Recipients in R"
date: 2012-01-19T12:30:00-08:00
categories:
 - Finance
 - Bailout
 - Banking
 - R
---

<div class='post'>
I was searching for open data recently, and stumbled on <a href="http://opendata.socrata.com/">Socrata</a>. Socrata has a lot of interesting data sets, and while I was browsing around, I found a data set on federal bailout recipients.  <a href="http://opendata.socrata.com/Government/Bailout-Recipients/gbdy-vjgr">Here</a> is the data set.  However, data sets on Socrata are not always the most recent versions, so I followed a link to the data source at <a href="http://projects.propublica.org/bailout/list/index">Propublica</a>, where I was able to find a data set that was last updated on January 17, 2012.  I downloaded the data in csv format.  In the rest of this post, I will perform basic analysis on this data, and show that R can be used to do the same analysis as Excel in a much simpler and more powerful way.<br /><br />The data contains several columns, the most salient of which are the name of the company, its location, its industry, the amount of bailout funds received, and the amount repaid.<br /><br />First, we read in the data:  <br /><pre>bailout&lt;-read.csv(file="bailout.csv",head=TRUE,sep=",",<br />stringsAsFactors=FALSE,strip.white=TRUE)<br /></pre>Next, we generate a variable called owed that calculates how much the company owes the government, or how much the government has made in profit from the company, and create a new data frame that is sorted based on how much is owed the government:  <br /><pre>bailout&lt;-transform(bailout,owed=bailout$total_disbursed<br />-bailout$total_revenue-bailout$total_payback)<br />ordered_bailout&lt;-bailout[with(bailout,order(-owed)),]<br /></pre>Now, we can use ggplot2 to create a nice looking bar chart, and use dev.copy() to export it(you do not need to run the last two lines, as they are solely for exporting the chart):  <br /><pre>library(ggplot2)<br />qplot(name,weight=owed/1e9, data = ordered_bailout[1:4,], <br />geom = "bar", xlab = "Institution Name",ylab="Amount Owed in Billions")<br />dev.copy(png,"most_owed.png")<br />dev.off()<br /></pre>This results in this chart:  <br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-1QVSKEGphIY/Txhyu30riRI/AAAAAAAAABA/pvoOwBkzqI0/s1600/most_owed.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://1.bp.blogspot.com/-1QVSKEGphIY/Txhyu30riRI/AAAAAAAAABA/pvoOwBkzqI0/s400/most_owed.png" width="400" /></a></div>As you can see, Fannie Mae, Freddie Mac, GM, and AIG all still owe huge amounts of money to the government.  Now, we look at the top companies that the government made a profit from:  <br /><pre>qplot(name,weight=abs(owed/1e9), data = tail(ordered_bailout,4), <br />geom = "bar", xlab = "Institution Name",<br />ylab="Government Profit in Billions")<br /></pre><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-hxMrlpXHUjk/TxhzakvX0mI/AAAAAAAAABM/A1-VNtMG60o/s1600/most_repaid.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://4.bp.blogspot.com/-hxMrlpXHUjk/TxhzakvX0mI/AAAAAAAAABM/A1-VNtMG60o/s400/most_repaid.png" width="400" /></a></div>As we can see, banks have given the government a significant profit. <br /><br />When we look at the sum of the money owed to the government, we see that <b>242.81 billion</b> dollars have yet to be repaid:  <br /><pre>sum(ordered_bailout$owed)/1e9<br /></pre>Using the tapply function reveals the following(each heading is a sector name, and the number below is how much they owe the government in billions):  <br /><pre>tapply(bailout$owed/1e9,bailout$category,sum)</pre><pre>&nbsp;</pre><pre>                      Bank              FHA Refinance Fund <br />                   -11.36362217                      0.05000000 <br />         SBA Security Purchases              State Housing Orgs <br />                     0.06002858                      0.65537461 <br />              Mortgage Servicer      Financial Services Company <br />                     1.93507502                     10.47640782 <br />                Investment Fund                    Auto Company <br />                    13.32980009                     28.53374026 <br />              Insurance Company  Government-Sponsored Enterprise <br />                    48.36100458                    150.77000000 <br /></pre> As you can see, the government sponsored enterprises(Fannie Mae and Freddie Mac), and the insurance companies(primarily AIG), owe the most while the banks have made a profit for the government.  I will not inject any analysis into this, as we are only looking at the numbers here.<br/><br/> Now, we will look at how much is owed by the top 10 states:  <pre><br />states<-sort(tapply(bailout$owed/1e9,bailout$state,sum))<br />qplot(tail(names(states),10),weight=tail(states,10))<br /></pre> <div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-_4tMgivu_48/Txh3zd4e2YI/AAAAAAAAABk/IA9wjCIP5I8/s1600/owed_by_state.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img border="0" height="400" width="400" src="http://2.bp.blogspot.com/-_4tMgivu_48/Txh3zd4e2YI/AAAAAAAAABk/IA9wjCIP5I8/s400/owed_by_state.png" /></a></div> Not surprisingly, considering that Fannie Mae and Freddie Mac are based in DC, DC owes the most, followed by Virginia.  Puerto Rico is a very interesting addition to the top 10 states/territories that owe the government, and further inspection reveals this:  <pre><br />bailout[bailout$state=="PR",]$name<br />[1] "Popular, Inc."                "First BanCorp"               <br />[3] "RG Mortgage Corporation"      "Scotiabank de Puerto Rico"   <br />[5] "Banco Popular de Puerto Rico"<br /></pre> Apparently the banking sector in Puerto Rico did not do well in the financial crisis!  <br/><br/>  I noticed an interesting column in the data called "is_stress_tested", which took on a false value, a true value, or a NULL value.  I am not an expert on banking, and if someone can please shed more light on the stress test, I would appreciate it, but I believe that stress testing is a method that discovers how prone to failure the institution is.<br/><br/> Now, when we see how much money the institutions that have had stress testing performed versus those that have not owe, we get the following:  <pre><br />tapply(bailout$owed/1e9,bailout$is_stress_tested,sum)<br />              false      true <br /> 13.31646 242.71883 -13.22748 <br /></pre> This tells us that institutions that have not been stress tested owe 242 billion to the government, whereas those that have been stress tested have made a profit of 13.2 billion for the government.  I am not sure if stress testing can be performed on an institution like Fannie Mae, but it seems odd that the testing has not been done on those institutions that collectively owe 242 billion dollars.<br/><br/> Finally, looking at the percentage of disbursed funds that are still outstanding by sector reveals the following(each heading is a sector name, and the number below is the percentage of the bailout funds that they still owe):  <pre><br />sort(tapply(bailout$owed,bailout$category,sum)/<br />tapply(bailout$total_disbursed,bailout$category,sum))<br />                           Bank          SBA Security Purchases <br />                    -0.04811175                      0.16305670 <br />                   Auto Company      Financial Services Company <br />                     0.46090662                      0.46762480 <br />              Insurance Company Government-Sponsored Enterprise <br />                     0.66995920                      0.82478118 <br />                Investment Fund              FHA Refinance Fund <br />                     0.84152859                      1.00000000 <br />              Mortgage Servicer              State Housing Orgs <br />                     1.00000000                      1.00000000 <br /></pre> In general, it appears that Investment Funds, Government-Sponsored Enterprises, and Insurance Companies have been poor at repaying the money they were lent.  The high values for Government Sponsored Enterprises and Insurance Companies are explained by the high outstanding amounts from Fannie Mae, Freddie Mac, and AIG, but the trend in Investment Funds in more interesting.  Despite relatively small bailouts(and I emphasize the relatively, because 15.8 billion dollars were disbursed to Investment Funds), it appears that money has been extremely slow to come back to the Government, with 84% of the funds still outstanding.<br/><br/> With that, I conclude this post.  I hope that this has shown you how simple data analysis can be done in R in an quick and efficient manner, and I hope that I have also been able to do interesting analyses and draw interesting facts from this data.</div>