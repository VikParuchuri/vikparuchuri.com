---
layout: post
title: "Using R in Ruby"
date: 2012-01-10T18:08:00-08:00
categories:
 - Ruby
 - Windows
 - R
---

<div class='post'>
Integrating R into more traditional programming languages can be incredibly rewarding due to R's powerful built-in statistical tools, but it can also be extremely frustrating at times.  Thankfully, like much else to do with Ruby, integrating R and Ruby is quite a simple process.  To begin, install the gem rinruby and require it in your script.<br><br> <pre class="ruby">gem install rinruby</pre> <pre class="ruby"><br />require 'rubygems'<br />require 'rinruby'<br /></pre> There is no further installation or configuration required.  To evaluate an R expression, use the R.eval command.<br> <pre class="ruby"> R.eval "test=1*1"</pre> To get a value from R, use the R.pull command.  <pre class="ruby"> test=R.pull "test" </pre> If you are running large code blocks, it is easy to use the R.eval command with the R source function.  This will evaluate the R instructions in a given text file.  <pre class="ruby">R.eval "source('C:/randomscript.R')"</pre> If you are receiving the below error when attempting to load packages, your R library path is not properly set in your rinruby created instance of R.    <pre class="ruby">Error in library(x) : there is no package called 'x'</pre>  You can correct this using the R .libPaths() function.  <pre class="ruby">R.eval('.libPaths("C:/Users/R library path")')</pre> To find out what your R library paths are, you should use the Sys.getenv function in R.  <pre class="ruby">Sys.getenv(c("R_LIBS", "R_LIBS_USER"))</pre> You should make sure that you set your library paths in the R instance created by rinruby to the same paths that appear when you run the Sys.getenv command in your R GUI.  A list of other useful environment variables can be found <a href="http://stat.ethz.ch/R-manual/R-patched/library/base/html/EnvVar.html">here</a>.  Another useful function to use in conjunction with rinruby is the setwd command.  <pre class="ruby">R.eval('setwd("C:/Users/Documents")')</pre> If you replace the file path above with your R working directory path, rinruby will save files in the right spot.<br><br> <b>Notes:</b><br><br> When typing file paths into Ruby for use in R, one should always use the forward slash(/), or four backslashes(\\\\), as single and double backslashes will not escape properly.<br><br> Note that using the R.pull command with multiple R instructions(or using it with the source() function) will often cause long runtimes, or will not complete.  Using the R.eval command to evaluate scripts, and then using the R.pull command to pull variables out after the script has finished executing will solve this issue.<br><br> You can find more information on this at the <a href="https://sites.google.com/a/ddahl.org/rinruby-users/">rinruby</a> site.</div>
